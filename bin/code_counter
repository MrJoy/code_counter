#! /usr/bin/env ruby
require File.expand_path('../../lib/code_counter/engine', __FILE__)
require File.expand_path('../../lib/code_counter/cli', __FILE__)

(ENV['ADDITIONAL_SOURCE_DIRECTORIES'] || '').split(',').each do |dir|
  (path, label) = CodeCounter::CLI.expand_labeled_path(dir)
  CodeCounter::Engine.add_path(label, path, true, false)
end

(ENV['ADDITIONAL_BINARY_DIRECTORIES'] || '').split(',').each do |dir|
  (path, label) = CodeCounter::CLI.expand_labeled_path(dir)
  CodeCounter::Engine.add_path(label, path, true, true)
end

user_ignored_globs = (ENV['IGNORE_FILE_GLOBS'] || '').split(',')

puts CodeCounter::Engine.new(user_ignored_globs).to_s
